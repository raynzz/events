// Create a new event
export const createEvent = async (eventData: {
  title: string;
  description: string;
  start_date: string;
  end_date: string;
  location: string;
  capacity: number;
  price: number;
  requires_liquor_license: boolean;
  status?: string;
  Responsable?: string; // ID del usuario responsable
}) => {
  const response = await fetch(`${directusUrl}/items/events`, {
    method: 'POST',
    headers: getHeaders(),
    body: JSON.stringify({
      ...eventData,
      status: eventData.status || 'draft'
    }),
  });

  if (!response.ok) {
    const error = await response.json();
    throw new Error(error.errors?.[0]?.message || 'Failed to create event');
  }

  return response.json();
};

// Read events filtered by user
export const readUserEvents = async (userId: string) => {
  const response = await fetch(`${directusUrl}/items/events?filter[Responsable][_eq]=${userId}&sort=-date_created&fields=*`, {
    headers: getHeaders(),
  });

  if (!response.ok) {
    throw new Error('Failed to read user events');
  }

  const data = await response.json();
  return data.data;
};
